---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
  Rendered inline template (2.1ms)
  Rendered inline template (0.3ms)
  Rendered inline template (0.2ms)
  Rendered inline template (0.2ms)
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
  Rendered inline template (1.4ms)
  Rendered inline template (0.1ms)
  Rendered inline template (0.2ms)
  Rendered inline template (0.2ms)
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
  Rendered inline template (3.2ms)
  Rendered inline template (0.3ms)
  Rendered inline template (0.3ms)
  Rendered inline template (0.1ms)
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
--------------------------------------------------------
SyncTest: test_check_synchronization_template_with_model
--------------------------------------------------------
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
  Rendered inline template (0.9ms)
  Rendered inline template (0.2ms)
  Rendered inline template (0.2ms)
  Rendered inline template (0.2ms)
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
--------------------------------------------------------
SyncTest: test_check_synchronization_template_with_model
--------------------------------------------------------
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} runtime: 8.7760ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 1.8130ms
  Rendered inline template (0.5ms)
  Rendered inline template (0.4ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('556d8ba16e6b757bed000000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 1.4920ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d8ba16e6b757bed010000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d8ba16e6b757bed000000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n  <p>Blocks could have not only plain HTML but a Ruby template code as well. For example these links below are going to be rendered and saved as HTML links in the page objects.</p>\n", "footer"=>"\n  <p>This is an example of the content block named footer.</p>\n"}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-02 10:55:29 UTC, "created_at"=>2015-06-02 10:55:29 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 182.4800ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('556d8ba16e6b757bed000000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n  <p>Blocks could have not only plain HTML but a Ruby template code as well. For example these links below are going to be rendered and saved as HTML links in the page objects.</p>\n", "footer"=>"\n  <p>This is an example of the content block named footer.</p>\n"}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-02 10:55:29 UTC, "created_at"=>2015-06-02 10:55:29 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 1.4500ms
  Rendered inline template (0.3ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-excluded(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('556d8ba16e6b757bed020000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 4.3800ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d8ba16e6b757bed030000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d8ba16e6b757bed020000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"Excluded", "_blocks"=>{"excluded block"=>"\n  <p>Blocks could have not only plain HTML but a Ruby template code as well. For example these links below are going to be rendered and saved as HTML links in the page objects.</p>\n"}, "_slugs"=>["pages-excluded"], "hero_image_url"=>"", "_template_name"=>"pages/excluded.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-02 10:55:29 UTC, "created_at"=>2015-06-02 10:55:29 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5840ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('556d8ba16e6b757bed020000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"Excluded", "_blocks"=>{"excluded block"=>"\n  <p>Blocks could have not only plain HTML but a Ruby template code as well. For example these links below are going to be rendered and saved as HTML links in the page objects.</p>\n"}, "_slugs"=>["pages-excluded"], "hero_image_url"=>"", "_template_name"=>"pages/excluded.html.erb", "updated_at"=>2015-06-02 10:55:29 UTC, "created_at"=>2015-06-02 10:55:29 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.7330ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 1.0890ms
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
  Rendered inline template (1.4ms)
  Rendered inline template (0.3ms)
  Rendered inline template (0.1ms)
  Rendered inline template (0.1ms)
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
--------------------------------------------------------
SyncTest: test_check_synchronization_template_with_model
--------------------------------------------------------
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} runtime: 1.1230ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.8380ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3620ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4070ms
--------------------------------------------------------
SyncTest: test_check_synchronization_template_with_model
--------------------------------------------------------
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} runtime: 1.0670ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6350ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{"_template_name"=>"pages/excluded.html.erb"}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.6390ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('556d8ba16e6b757bed020000')} flags=[:remove_first]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 1.9880ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5480ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4300ms
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
  Rendered inline template (0.8ms)
  Rendered inline template (0.1ms)
  Rendered inline template (0.1ms)
  Rendered inline template (0.1ms)
--------------------------------------------------------
SyncTest: test_check_synchronization_template_with_model
--------------------------------------------------------
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} runtime: 1.0220ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4770ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4680ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.5160ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4830ms
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
  Rendered inline template (0.9ms)
  Rendered inline template (0.1ms)
  Rendered inline template (0.1ms)
  Rendered inline template (0.1ms)
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
  Rendered inline template (1.1ms)
  Rendered inline template (0.2ms)
  Rendered inline template (0.2ms)
  Rendered inline template (0.2ms)
--------------------------------------------------------
SyncTest: test_check_synchronization_template_with_model
--------------------------------------------------------
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} runtime: 0.9780ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5130ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4450ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.3040ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4470ms
--------------------------------------------------------
SyncTest: test_check_synchronization_template_with_model
--------------------------------------------------------
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} runtime: 0.9950ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5080ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4610ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.3950ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4600ms
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
  Rendered inline template (1.8ms)
  Rendered inline template (0.2ms)
  Rendered inline template (0.1ms)
  Rendered inline template (0.1ms)
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
---------------------------------------------------------------------
SyncTest: test_check_initial_synchronization_of_templates_with_models
---------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} runtime: 0.9870ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5180ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3730ms
  Rendered inline template (1.0ms)
  Rendered inline template (0.1ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('556d8ba16e6b757bed000000')} update={"$set"=>{"updated_at"=>2015-06-02 11:20:25 UTC}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 2.0380ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.3610ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.5160ms
------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_removal
------------------------------------------------------------------------------
-------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_creation
-------------------------------------------------------------------------------
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
  Rendered inline template (0.2ms)
  Rendered inline template (0.2ms)
  Rendered inline template (0.2ms)
  Rendered inline template (0.1ms)
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
---------------------------------------------------------------------
SyncTest: test_check_initial_synchronization_of_templates_with_models
---------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} runtime: 1.4640ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5650ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4360ms
  Rendered inline template (1.1ms)
  Rendered inline template (0.2ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('556d8ba16e6b757bed000000')} update={"$set"=>{"updated_at"=>2015-06-02 11:22:08 UTC}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5010ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.3420ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3910ms
-------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_creation
-------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.7000ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5880ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5310ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.2830ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.2420ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.7130ms
------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_removal
------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6820ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 1.3370ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.8010ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5690ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.3830ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.6190ms
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
  Rendered inline template (0.5ms)
  Rendered inline template (0.3ms)
  Rendered inline template (0.1ms)
  Rendered inline template (0.2ms)
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
  Rendered inline template (0.9ms)
  Rendered inline template (0.1ms)
  Rendered inline template (0.1ms)
  Rendered inline template (0.2ms)
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
---------------------------------------------------------------------
SyncTest: test_check_initial_synchronization_of_templates_with_models
---------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} runtime: 0.9150ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4460ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3550ms
  Rendered inline template (0.2ms)
  Rendered inline template (0.2ms)
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('556d8ba16e6b757bed000000')} update={"$set"=>{"updated_at"=>2015-06-02 11:23:30 UTC}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.7180ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.3120ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.5580ms
------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_removal
------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.8010ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3590ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5140ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 1.8320ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.4350ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4200ms
-------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_creation
-------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.9200ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3870ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5950ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6460ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.8660ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 1.3480ms
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
---------------------------------------------------------------------
SyncTest: test_check_initial_synchronization_of_templates_with_models
---------------------------------------------------------------------
-------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_creation
-------------------------------------------------------------------------------
------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_removal
------------------------------------------------------------------------------
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} runtime: 1.2890ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 1.0080ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5850ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4910ms
  Rendered inline template (1.0ms)
  Rendered inline template (0.2ms)
  Rendered inline template (0.1ms)
  Rendered inline template (0.1ms)
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4960ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2740ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3090ms
-------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_creation
-------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5730ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3540ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3400ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.2860ms
  Rendered inline template (0.4ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('556d94946e6b7583aa000000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5290ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d94946e6b7583aa010000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d94946e6b7583aa000000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-02 11:33:40 UTC, "created_at"=>2015-06-02 11:33:40 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.6960ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('556d94946e6b7583aa000000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-02 11:33:40 UTC, "created_at"=>2015-06-02 11:33:40 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3520ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4170ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5100ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5630ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.4350ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4930ms
---------------------------------------------------------------------
SyncTest: test_check_initial_synchronization_of_templates_with_models
---------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 2.5990ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5050ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5080ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3530ms
  Rendered inline template (0.4ms)
  Rendered inline template (0.3ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('556d94946e6b7583aa020000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5540ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d94946e6b7583aa030000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d94946e6b7583aa020000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-02 11:33:40 UTC, "created_at"=>2015-06-02 11:33:40 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5240ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('556d94946e6b7583aa020000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-02 11:33:40 UTC, "created_at"=>2015-06-02 11:33:40 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5380ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5390ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.3240ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4430ms
------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_removal
------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.7800ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5000ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4060ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4580ms
  Rendered inline template (0.6ms)
  Rendered inline template (0.4ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('556d94946e6b7583aa040000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.8340ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d94946e6b7583aa050000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d94946e6b7583aa040000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-02 11:33:40 UTC, "created_at"=>2015-06-02 11:33:40 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 1.1940ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('556d94946e6b7583aa040000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-02 11:33:40 UTC, "created_at"=>2015-06-02 11:33:40 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.9620ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.9310ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5590ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.7410ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.9430ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 2.1930ms
---------------------------------------------------------------------
SyncTest: test_check_initial_synchronization_of_templates_with_models
---------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} runtime: 1.0960ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4580ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3560ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2940ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3060ms
  Rendered inline template (2.1ms)
  Rendered inline template (0.2ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('556d94fa6e6b7583ed000000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.7810ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d94fa6e6b7583ed010000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d94fa6e6b7583ed000000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-02 11:35:22 UTC, "created_at"=>2015-06-02 11:35:22 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.6570ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('556d94fa6e6b7583ed000000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-02 11:35:22 UTC, "created_at"=>2015-06-02 11:35:22 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4920ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4280ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.8020ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.5970ms
------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_removal
------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6580ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3030ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2780ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4590ms
  Rendered inline template (0.3ms)
  Rendered inline template (0.2ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('556d94fa6e6b7583ed020000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5060ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d94fa6e6b7583ed030000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d94fa6e6b7583ed020000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-02 11:35:22 UTC, "created_at"=>2015-06-02 11:35:22 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.7930ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('556d94fa6e6b7583ed020000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-02 11:35:22 UTC, "created_at"=>2015-06-02 11:35:22 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4370ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6310ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 1.2910ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.8550ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.7530ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.4370ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.6320ms
-------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_creation
-------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5760ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3930ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4010ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4730ms
  Rendered inline template (0.5ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('556d94fa6e6b7583ed040000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4810ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d94fa6e6b7583ed050000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d94fa6e6b7583ed040000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-02 11:35:22 UTC, "created_at"=>2015-06-02 11:35:22 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.7430ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('556d94fa6e6b7583ed040000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-02 11:35:22 UTC, "created_at"=>2015-06-02 11:35:22 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5200ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5450ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4580ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4090ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.3560ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.6390ms
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 2.0440ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3950ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.8020ms
  Rendered inline template (0.8ms)
  Rendered inline template (0.2ms)
  Rendered inline template (0.6ms)
  Rendered inline template (0.2ms)
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.7290ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4970ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5260ms
---------------------------------------------------------------------
SyncTest: test_check_initial_synchronization_of_templates_with_models
---------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} runtime: 1.1050ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4180ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4530ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2770ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3230ms
  Rendered inline template (1.1ms)
  Rendered inline template (0.2ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('556d95986e6b758460000000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5120ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d95986e6b758460010000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d95986e6b758460000000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-02 11:38:00 UTC, "created_at"=>2015-06-02 11:38:00 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5450ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('556d95986e6b758460000000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-02 11:38:00 UTC, "created_at"=>2015-06-02 11:38:00 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4460ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.7150ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.3600ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.5180ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.8720ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4600ms
-------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_creation
-------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5370ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4460ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3320ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3320ms
  Rendered inline template (0.2ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('556d95986e6b758460020000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5200ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d95986e6b758460030000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d95986e6b758460020000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-02 11:38:00 UTC, "created_at"=>2015-06-02 11:38:00 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4620ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('556d95986e6b758460020000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-02 11:38:00 UTC, "created_at"=>2015-06-02 11:38:00 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2910ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4180ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6180ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.7350ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.3600ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.5660ms
------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_removal
------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6530ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.6760ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4090ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4530ms
  Rendered inline template (0.4ms)
  Rendered inline template (0.2ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('556d95986e6b758460040000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5690ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d95986e6b758460050000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d95986e6b758460040000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-02 11:38:00 UTC, "created_at"=>2015-06-02 11:38:00 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4750ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('556d95986e6b758460040000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-02 11:38:00 UTC, "created_at"=>2015-06-02 11:38:00 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3910ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4850ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4810ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3210ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3570ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.2850ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4160ms
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4420ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3080ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2950ms
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.7530ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2740ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.6350ms
  Rendered inline template (0.6ms)
  Rendered inline template (0.2ms)
  Rendered inline template (0.5ms)
  Rendered inline template (0.1ms)
------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_removal
------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} runtime: 1.1190ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4030ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2980ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2780ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.2530ms
  Rendered inline template (1.5ms)
  Rendered inline template (0.2ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('556d95fd6e6b7584d2000000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5990ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d95fd6e6b7584d2010000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d95fd6e6b7584d2000000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-02 11:39:41 UTC, "created_at"=>2015-06-02 11:39:41 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.7320ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('556d95fd6e6b7584d2000000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-02 11:39:41 UTC, "created_at"=>2015-06-02 11:39:41 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4200ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5600ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5980ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4210ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4090ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.5150ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.5180ms
-------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_creation
-------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4790ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4220ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3650ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3720ms
  Rendered inline template (0.3ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('556d95fd6e6b7584d2020000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4340ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d95fd6e6b7584d2030000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d95fd6e6b7584d2020000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-02 11:39:41 UTC, "created_at"=>2015-06-02 11:39:41 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4850ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('556d95fd6e6b7584d2020000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-02 11:39:41 UTC, "created_at"=>2015-06-02 11:39:41 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3440ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3680ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4760ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4000ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.3590ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4900ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.6980ms
---------------------------------------------------------------------
SyncTest: test_check_initial_synchronization_of_templates_with_models
---------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6220ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4620ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3570ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5510ms
  Rendered inline template (0.3ms)
  Rendered inline template (0.5ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('556d95fd6e6b7584d2040000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5720ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d95fd6e6b7584d2050000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d95fd6e6b7584d2040000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-02 11:39:41 UTC, "created_at"=>2015-06-02 11:39:41 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5720ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('556d95fd6e6b7584d2040000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-02 11:39:41 UTC, "created_at"=>2015-06-02 11:39:41 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5450ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 1.6120ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.5430ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 1.6890ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 1.7900ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 1.1260ms
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4610ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.7510ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2900ms
  Rendered inline template (0.4ms)
  Rendered inline template (0.7ms)
  Rendered inline template (0.4ms)
  Rendered inline template (0.8ms)
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.7500ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 1.7150ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5150ms
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} runtime: 0.9680ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4000ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3630ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3220ms
  Rendered inline template (1.0ms)
  Rendered inline template (0.2ms)
  Rendered inline template (0.1ms)
  Rendered inline template (0.1ms)
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6630ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3160ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3780ms
---------------------------------------------------------------------
SyncTest: test_check_initial_synchronization_of_templates_with_models
---------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6920ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5240ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5260ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3790ms
  Rendered inline template (0.5ms)
  Rendered inline template (0.7ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('556d995a6e6b75866e000000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 1.1060ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d995a6e6b75866e010000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d995a6e6b75866e000000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-02 11:54:02 UTC, "created_at"=>2015-06-02 11:54:02 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.8510ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('556d995a6e6b75866e000000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-02 11:54:02 UTC, "created_at"=>2015-06-02 11:54:02 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.7790ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4230ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.2770ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.5960ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4190ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4840ms
-------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_creation
-------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.9380ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4380ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3110ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5180ms
  Rendered inline template (1.1ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('556d995a6e6b75866e020000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6100ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d995a6e6b75866e030000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d995a6e6b75866e020000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-02 11:54:02 UTC, "created_at"=>2015-06-02 11:54:02 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5450ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('556d995a6e6b75866e020000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-02 11:54:02 UTC, "created_at"=>2015-06-02 11:54:02 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4330ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6020ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5630ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5050ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.3210ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4230ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3730ms
------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_removal
------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3930ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3530ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3260ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3530ms
  Rendered inline template (0.3ms)
  Rendered inline template (0.6ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('556d995a6e6b75866e040000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4890ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d995a6e6b75866e050000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d995a6e6b75866e040000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-02 11:54:02 UTC, "created_at"=>2015-06-02 11:54:02 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.6190ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('556d995a6e6b75866e040000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-02 11:54:02 UTC, "created_at"=>2015-06-02 11:54:02 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.7860ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.7310ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5440ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5000ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.9440ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.3220ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.6940ms
------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_removal
------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} runtime: 0.9840ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4150ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4110ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3520ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.2900ms
  Rendered inline template (0.9ms)
  Rendered inline template (0.2ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('556d99ce6e6b7586ad000000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5070ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d99ce6e6b7586ad010000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d99ce6e6b7586ad000000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-02 11:55:58 UTC, "created_at"=>2015-06-02 11:55:58 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.6290ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('556d99ce6e6b7586ad000000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-02 11:55:58 UTC, "created_at"=>2015-06-02 11:55:58 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5270ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.8340ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.7420ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4510ms
  Rendered inline template (0.6ms)
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d99cf6e6b7586ad020000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d99ce6e6b7586ad000000')}], "scope"=>"page", "original"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}}, "modified"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}}, "version"=>2, "action"=>"update", "updated_at"=>2015-06-02 11:55:59 UTC, "created_at"=>2015-06-02 11:55:59 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.7080ms
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('556d99ce6e6b7586ad000000')} update={"$set"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "updated_at"=>2015-06-02 11:55:59 UTC, "version"=>2}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 1.0970ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.5820ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.3480ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3910ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3450ms
-------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_creation
-------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3380ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4170ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2660ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4340ms
  Rendered inline template (0.3ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('556d99cf6e6b7586ad030000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5580ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d99cf6e6b7586ad040000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d99cf6e6b7586ad030000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-02 11:55:59 UTC, "created_at"=>2015-06-02 11:55:59 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.6900ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('556d99cf6e6b7586ad030000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-02 11:55:59 UTC, "created_at"=>2015-06-02 11:55:59 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.7880ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5420ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.8990ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4790ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.3530ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4410ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4070ms
---------------------------------------------------------------------
SyncTest: test_check_initial_synchronization_of_templates_with_models
---------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4820ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4750ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4130ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3430ms
  Rendered inline template (0.2ms)
  Rendered inline template (0.2ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('556d99cf6e6b7586ad050000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4960ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d99cf6e6b7586ad060000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d99cf6e6b7586ad050000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-02 11:55:59 UTC, "created_at"=>2015-06-02 11:55:59 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5530ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('556d99cf6e6b7586ad050000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-02 11:55:59 UTC, "created_at"=>2015-06-02 11:55:59 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4730ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4680ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.4960ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 1.0420ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 1.8600ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.9720ms
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4680ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.6140ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2680ms
  Rendered inline template (0.3ms)
  Rendered inline template (0.3ms)
  Rendered inline template (0.2ms)
  Rendered inline template (0.2ms)
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 1.0330ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4470ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.8140ms
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} runtime: 0.8960ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4110ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4030ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4150ms
  Rendered inline template (2.4ms)
  Rendered inline template (0.4ms)
  Rendered inline template (0.3ms)
  Rendered inline template (0.3ms)
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.7360ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.7000ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 1.1940ms
------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_removal
------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 2.2440ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4650ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3430ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3560ms
  Rendered inline template (0.4ms)
  Rendered inline template (0.3ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('556d9a3c6e6b7586d0000000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6510ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d9a3c6e6b7586d0010000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d9a3c6e6b7586d0000000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-02 11:57:48 UTC, "created_at"=>2015-06-02 11:57:48 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.6430ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('556d9a3c6e6b7586d0000000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-02 11:57:48 UTC, "created_at"=>2015-06-02 11:57:48 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3390ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5780ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6470ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4010ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.5180ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.3580ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4210ms
------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_removal
------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} runtime: 1.1550ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5330ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3770ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4110ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3530ms
  Rendered inline template (0.8ms)
  Rendered inline template (0.2ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('556d9b196e6b758725000000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6820ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d9b196e6b758725010000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d9b196e6b758725000000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-02 12:01:29 UTC, "created_at"=>2015-06-02 12:01:29 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.8520ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('556d9b196e6b758725000000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-02 12:01:29 UTC, "created_at"=>2015-06-02 12:01:29 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4470ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4980ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5290ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5940ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.7540ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.3300ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4270ms
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3190ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.7750ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3750ms
  Rendered inline template (0.2ms)
  Rendered inline template (0.1ms)
  Rendered inline template (0.2ms)
  Rendered inline template (0.1ms)
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6420ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2470ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2800ms
------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_removal
------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} runtime: 1.2160ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4600ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3730ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2960ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.2600ms
  Rendered inline template (1.1ms)
  Rendered inline template (0.2ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('556d9ba76e6b758761000000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5280ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d9ba76e6b758761010000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d9ba76e6b758761000000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-02 12:03:51 UTC, "created_at"=>2015-06-02 12:03:51 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4800ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('556d9ba76e6b758761000000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-02 12:03:51 UTC, "created_at"=>2015-06-02 12:03:51 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3930ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4770ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4120ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4090ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4060ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.2520ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3890ms
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.7650ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4050ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4200ms
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3920ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4410ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4070ms
  Rendered inline template (0.2ms)
  Rendered inline template (0.2ms)
  Rendered inline template (0.2ms)
  Rendered inline template (0.1ms)
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} runtime: 1.0660ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4510ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3640ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3390ms
  Rendered inline template (0.9ms)
  Rendered inline template (0.1ms)
  Rendered inline template (0.2ms)
  Rendered inline template (0.1ms)
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4850ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2870ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2680ms
------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_removal
------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3250ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2430ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5000ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.2720ms
  Rendered inline template (0.4ms)
  Rendered inline template (0.2ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('556d9c226e6b7587e7000000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.7710ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d9c226e6b7587e7010000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d9c226e6b7587e7000000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-02 12:05:54 UTC, "created_at"=>2015-06-02 12:05:54 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.6250ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('556d9c226e6b7587e7000000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-02 12:05:54 UTC, "created_at"=>2015-06-02 12:05:54 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4360ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4070ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4380ms
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} runtime: 3.6570ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5550ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4290ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.6890ms
  Rendered inline template (0.9ms)
  Rendered inline template (0.2ms)
  Rendered inline template (0.2ms)
  Rendered inline template (0.2ms)
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4570ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4870ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5900ms
------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_removal
------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6990ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3030ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.9550ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6970ms
  Rendered inline template (0.5ms)
  Rendered inline template (0.2ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('556d9c3f6e6b7587ff000000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5610ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d9c3f6e6b7587ff010000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d9c3f6e6b7587ff000000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-02 12:06:23 UTC, "created_at"=>2015-06-02 12:06:23 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5450ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('556d9c3f6e6b7587ff000000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-02 12:06:23 UTC, "created_at"=>2015-06-02 12:06:23 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3460ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3770ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3520ms
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('556d9c3f6e6b7587ff000000')} update={"$set"=>{"updated_at"=>2015-06-01 00:00:00 UTC}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3940ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3970ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3310ms
  Rendered inline template (0.4ms)
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d9c3f6e6b7587ff020000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d9c3f6e6b7587ff000000')}], "scope"=>"page", "original"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}}, "modified"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}}, "version"=>2, "action"=>"update", "updated_at"=>2015-06-02 12:06:23 UTC, "created_at"=>2015-06-02 12:06:23 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5170ms
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('556d9c3f6e6b7587ff000000')} update={"$set"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "updated_at"=>2015-06-02 12:06:23 UTC, "version"=>2}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 1.0940ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.7300ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.4900ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.6750ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.5380ms
---------------------------------------------------------------------
SyncTest: test_check_initial_synchronization_of_templates_with_models
---------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} runtime: 0.9590ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4400ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3360ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3380ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3810ms
  Rendered inline template (1.1ms)
  Rendered inline template (0.3ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('556d9cca6e6b7588a4000000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.7700ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d9cca6e6b7588a4010000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d9cca6e6b7588a4000000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-02 12:08:42 UTC, "created_at"=>2015-06-02 12:08:42 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.7600ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('556d9cca6e6b7588a4000000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-02 12:08:42 UTC, "created_at"=>2015-06-02 12:08:42 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.9760ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 1.1860ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.5640ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.5670ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4540ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3570ms
------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_removal
------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5280ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3210ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3140ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4670ms
  Rendered inline template (0.4ms)
  Rendered inline template (0.3ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('556d9ccb6e6b7588a4020000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5650ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d9ccb6e6b7588a4030000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d9ccb6e6b7588a4020000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-02 12:08:43 UTC, "created_at"=>2015-06-02 12:08:43 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.8000ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('556d9ccb6e6b7588a4020000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-02 12:08:43 UTC, "created_at"=>2015-06-02 12:08:43 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3980ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5890ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4310ms
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('556d9ccb6e6b7588a4020000')} update={"$set"=>{"updated_at"=>2015-06-01 00:00:00 UTC}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.8130ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.7930ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4370ms
  Rendered inline template (0.3ms)
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d9ccb6e6b7588a4040000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d9ccb6e6b7588a4020000')}], "scope"=>"page", "original"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}}, "modified"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}}, "version"=>2, "action"=>"update", "updated_at"=>2015-06-02 12:08:43 UTC, "created_at"=>2015-06-02 12:08:43 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.6680ms
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('556d9ccb6e6b7588a4020000')} update={"$set"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "updated_at"=>2015-06-02 12:08:43 UTC, "version"=>2}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5860ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.2400ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4530ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4240ms
-------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_creation
-------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3660ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3600ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3180ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4320ms
  Rendered inline template (0.3ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('556d9ccb6e6b7588a4050000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6650ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d9ccb6e6b7588a4060000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d9ccb6e6b7588a4050000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-02 12:08:43 UTC, "created_at"=>2015-06-02 12:08:43 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.6740ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('556d9ccb6e6b7588a4050000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-02 12:08:43 UTC, "created_at"=>2015-06-02 12:08:43 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.9180ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6320ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.7900ms
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('556d9ccb6e6b7588a4050000')} update={"$set"=>{"updated_at"=>2015-06-01 00:00:00 UTC}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4130ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4790ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4420ms
  Rendered inline template (0.5ms)
  Rendered inline template (0.3ms)
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('556d9ccb6e6b7588a4070000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('556d9ccb6e6b7588a4050000')}], "scope"=>"page", "original"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}}, "modified"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}}, "version"=>2, "action"=>"update", "updated_at"=>2015-06-02 12:08:43 UTC, "created_at"=>2015-06-02 12:08:43 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 1.3170ms
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('556d9ccb6e6b7588a4050000')} update={"$set"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "updated_at"=>2015-06-02 12:08:43 UTC, "version"=>2}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 1.0040ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.8530ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.7810ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3240ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.5920ms
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4340ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.6990ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2800ms
  Rendered inline template (0.2ms)
  Rendered inline template (0.3ms)
  Rendered inline template (0.1ms)
  Rendered inline template (0.1ms)
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4820ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4450ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2590ms
---------------------------------------------------------------------
SyncTest: test_check_initial_synchronization_of_templates_with_models
---------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} runtime: 0.8240ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 1.1650ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.9570ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 1.0420ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3020ms
  Rendered inline template (2.6ms)
  Rendered inline template (0.4ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('5577279b6e6b75234d000000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 1.6730ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('5577279b6e6b75234d010000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('5577279b6e6b75234d000000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-09 17:51:23 UTC, "created_at"=>2015-06-09 17:51:23 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 2.5810ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('5577279b6e6b75234d000000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-09 17:51:23 UTC, "created_at"=>2015-06-09 17:51:23 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4810ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4800ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.3460ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4000ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3310ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3150ms
-------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_creation
-------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6100ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3730ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2770ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4830ms
  Rendered inline template (0.3ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('5577279b6e6b75234d020000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6570ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('5577279b6e6b75234d030000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('5577279b6e6b75234d020000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-09 17:51:23 UTC, "created_at"=>2015-06-09 17:51:23 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.7900ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('5577279b6e6b75234d020000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-09 17:51:23 UTC, "created_at"=>2015-06-09 17:51:23 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5680ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4010ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4340ms
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('5577279b6e6b75234d020000')} update={"$set"=>{"updated_at"=>2015-06-08 00:00:00 UTC}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.6260ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4770ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4520ms
  Rendered inline template (0.3ms)
  Rendered inline template (0.3ms)
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('5577279b6e6b75234d040000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('5577279b6e6b75234d020000')}], "scope"=>"page", "original"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}}, "modified"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}}, "version"=>2, "action"=>"update", "updated_at"=>2015-06-09 17:51:23 UTC, "created_at"=>2015-06-09 17:51:23 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.6130ms
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('5577279b6e6b75234d020000')} update={"$set"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "updated_at"=>2015-06-09 17:51:23 UTC, "version"=>2}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 1.0510ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.4090ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4890ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4390ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4550ms
------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_removal
------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4930ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4160ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3940ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.2430ms
  Rendered inline template (0.4ms)
  Rendered inline template (0.3ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('5577279b6e6b75234d050000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6410ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('5577279b6e6b75234d060000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('5577279b6e6b75234d050000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-09 17:51:23 UTC, "created_at"=>2015-06-09 17:51:23 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.7230ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('5577279b6e6b75234d050000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-09 17:51:23 UTC, "created_at"=>2015-06-09 17:51:23 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3810ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4010ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.6830ms
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('5577279b6e6b75234d050000')} update={"$set"=>{"updated_at"=>2015-06-08 00:00:00 UTC}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3760ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3980ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3310ms
  Rendered inline template (0.2ms)
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('5577279b6e6b75234d070000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('5577279b6e6b75234d050000')}], "scope"=>"page", "original"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}}, "modified"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}}, "version"=>2, "action"=>"update", "updated_at"=>2015-06-09 17:51:23 UTC, "created_at"=>2015-06-09 17:51:23 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4890ms
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('5577279b6e6b75234d050000')} update={"$set"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "updated_at"=>2015-06-09 17:51:23 UTC, "version"=>2}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4840ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.3110ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3890ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3290ms
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.8620ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4030ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2380ms
  Rendered inline template (0.2ms)
  Rendered inline template (0.1ms)
  Rendered inline template (0.1ms)
  Rendered inline template (0.2ms)
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4630ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2700ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2470ms
-----------------------------------------------------
RendererTest: test_doesn't_change_html_without_blocks
-----------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4400ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2830ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2440ms
------------------------------------------
RendererTest: test_change_html_with_blocks
------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4860ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3210ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3530ms
------------------------------------------
RendererTest: test_change_html_with_blocks
------------------------------------------
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} runtime: 1.0980ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4540ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3390ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2870ms
-----------------------------------------------------
RendererTest: test_doesn't_change_html_without_blocks
-----------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.9050ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4330ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 1.1530ms
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 5.1100ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.6410ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3360ms
  Rendered inline template (2.0ms)
  Rendered inline template (0.3ms)
  Rendered inline template (0.3ms)
  Rendered inline template (0.2ms)
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6240ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.6430ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5510ms
---------------------------------------------------------------------
SyncTest: test_check_initial_synchronization_of_templates_with_models
---------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.9900ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5300ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3470ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4120ms
  Rendered inline template (0.3ms)
  Rendered inline template (0.2ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('557727c26e6b752387000000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5750ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('557727c26e6b752387010000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('557727c26e6b752387000000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-09 17:52:02 UTC, "created_at"=>2015-06-09 17:52:02 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.9910ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('557727c26e6b752387000000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-09 17:52:02 UTC, "created_at"=>2015-06-09 17:52:02 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5350ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5310ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.2940ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3560ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3290ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3160ms
-------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_creation
-------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3550ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3400ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3020ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3410ms
  Rendered inline template (0.3ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('557727c26e6b752387020000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6690ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('557727c26e6b752387030000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('557727c26e6b752387020000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-09 17:52:02 UTC, "created_at"=>2015-06-09 17:52:02 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5710ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('557727c26e6b752387020000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-09 17:52:02 UTC, "created_at"=>2015-06-09 17:52:02 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3580ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4740ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4240ms
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('557727c26e6b752387020000')} update={"$set"=>{"updated_at"=>2015-06-08 00:00:00 UTC}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.6060ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4170ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3740ms
  Rendered inline template (0.3ms)
  Rendered inline template (0.2ms)
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('557727c26e6b752387040000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('557727c26e6b752387020000')}], "scope"=>"page", "original"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}}, "modified"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}}, "version"=>2, "action"=>"update", "updated_at"=>2015-06-09 17:52:02 UTC, "created_at"=>2015-06-09 17:52:02 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4770ms
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('557727c26e6b752387020000')} update={"$set"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "updated_at"=>2015-06-09 17:52:02 UTC, "version"=>2}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.7290ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.2170ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3630ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3240ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3420ms
------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_removal
------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4940ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4710ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3420ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3450ms
  Rendered inline template (0.5ms)
  Rendered inline template (0.3ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('557727c26e6b752387050000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.9730ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('557727c26e6b752387060000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('557727c26e6b752387050000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-09 17:52:02 UTC, "created_at"=>2015-06-09 17:52:02 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.6340ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('557727c26e6b752387050000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-09 17:52:02 UTC, "created_at"=>2015-06-09 17:52:02 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.8500ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5570ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4740ms
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('557727c26e6b752387050000')} update={"$set"=>{"updated_at"=>2015-06-08 00:00:00 UTC}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5060ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4990ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4870ms
  Rendered inline template (0.6ms)
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('557727c26e6b752387070000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('557727c26e6b752387050000')}], "scope"=>"page", "original"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}}, "modified"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}}, "version"=>2, "action"=>"update", "updated_at"=>2015-06-09 17:52:02 UTC, "created_at"=>2015-06-09 17:52:02 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.7240ms
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('557727c26e6b752387050000')} update={"$set"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "updated_at"=>2015-06-09 17:52:02 UTC, "version"=>2}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.6000ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.3390ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.5110ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.5300ms
------------------------------------------
RendererTest: test_change_html_with_blocks
------------------------------------------
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} runtime: 0.9260ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4220ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4080ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3430ms
-----------------------------------------------------
RendererTest: test_doesn't_change_html_without_blocks
-----------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6480ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4100ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3170ms
---------------------------------------------------------------------
SyncTest: test_check_initial_synchronization_of_templates_with_models
---------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5590ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3950ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3120ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3530ms
  Rendered inline template (1.1ms)
  Rendered inline template (0.2ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('557728176e6b7523e0000000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5370ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('557728176e6b7523e0010000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('557728176e6b7523e0000000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-09 17:53:27 UTC, "created_at"=>2015-06-09 17:53:27 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5930ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('557728176e6b7523e0000000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-09 17:53:27 UTC, "created_at"=>2015-06-09 17:53:27 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.7100ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6040ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.4270ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.6280ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.5740ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.7170ms
-------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_creation
-------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6360ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4080ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2690ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5880ms
  Rendered inline template (0.3ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('557728176e6b7523e0020000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4420ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('557728176e6b7523e0030000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('557728176e6b7523e0020000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-09 17:53:27 UTC, "created_at"=>2015-06-09 17:53:27 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4630ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('557728176e6b7523e0020000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-09 17:53:27 UTC, "created_at"=>2015-06-09 17:53:27 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4110ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5990ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4020ms
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('557728176e6b7523e0020000')} update={"$set"=>{"updated_at"=>2015-06-08 00:00:00 UTC}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4300ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3350ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3170ms
  Rendered inline template (0.3ms)
  Rendered inline template (0.2ms)
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('557728176e6b7523e0040000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('557728176e6b7523e0020000')}], "scope"=>"page", "original"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}}, "modified"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}}, "version"=>2, "action"=>"update", "updated_at"=>2015-06-09 17:53:27 UTC, "created_at"=>2015-06-09 17:53:27 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4790ms
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('557728176e6b7523e0020000')} update={"$set"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "updated_at"=>2015-06-09 17:53:27 UTC, "version"=>2}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4930ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.3420ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3780ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3360ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3630ms
------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_removal
------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3580ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3020ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3270ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3420ms
  Rendered inline template (0.4ms)
  Rendered inline template (0.3ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('557728176e6b7523e0050000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6790ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('557728176e6b7523e0060000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('557728176e6b7523e0050000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-09 17:53:27 UTC, "created_at"=>2015-06-09 17:53:27 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.6800ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('557728176e6b7523e0050000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-09 17:53:27 UTC, "created_at"=>2015-06-09 17:53:27 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4560ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5740ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4440ms
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('557728176e6b7523e0050000')} update={"$set"=>{"updated_at"=>2015-06-08 00:00:00 UTC}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3980ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4160ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5450ms
  Rendered inline template (0.3ms)
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('557728176e6b7523e0070000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('557728176e6b7523e0050000')}], "scope"=>"page", "original"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}}, "modified"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}}, "version"=>2, "action"=>"update", "updated_at"=>2015-06-09 17:53:27 UTC, "created_at"=>2015-06-09 17:53:27 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.6580ms
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('557728176e6b7523e0050000')} update={"$set"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "updated_at"=>2015-06-09 17:53:27 UTC, "version"=>2}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.6200ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.3350ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3700ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3240ms
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5010ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3510ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3270ms
  Rendered inline template (0.7ms)
  Rendered inline template (0.2ms)
  Rendered inline template (0.2ms)
  Rendered inline template (0.2ms)
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 5.0610ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5060ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4040ms
------------------------------------------
RendererTest: test_change_html_with_blocks
------------------------------------------
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} runtime: 0.8910ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4110ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3330ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2810ms
-----------------------------------------------------
RendererTest: test_doesn't_change_html_without_blocks
-----------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6260ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3900ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3770ms
-------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_creation
-------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4460ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2620ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3380ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4800ms
  Rendered inline template (1.6ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('557728e56e6b752440000000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 1.0070ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('557728e56e6b752440010000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('557728e56e6b752440000000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-09 17:56:53 UTC, "created_at"=>2015-06-09 17:56:53 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.6780ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('557728e56e6b752440000000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-09 17:56:53 UTC, "created_at"=>2015-06-09 17:56:53 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3510ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4990ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.5700ms
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('557728e56e6b752440000000')} update={"$set"=>{"updated_at"=>2015-06-08 00:00:00 UTC}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.7860ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 1.0050ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6200ms
  Rendered inline template (0.6ms)
  Rendered inline template (0.3ms)
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('557728e56e6b752440020000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('557728e56e6b752440000000')}], "scope"=>"page", "original"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}}, "modified"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}}, "version"=>2, "action"=>"update", "updated_at"=>2015-06-09 17:56:53 UTC, "created_at"=>2015-06-09 17:56:53 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.7880ms
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('557728e56e6b752440000000')} update={"$set"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "updated_at"=>2015-06-09 17:56:53 UTC, "version"=>2}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.6120ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.3260ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.8440ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.5060ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.5010ms
---------------------------------------------------------------------
SyncTest: test_check_initial_synchronization_of_templates_with_models
---------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6890ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5740ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4310ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6110ms
  Rendered inline template (0.6ms)
  Rendered inline template (0.4ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('557728e56e6b752440030000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5620ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('557728e56e6b752440040000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('557728e56e6b752440030000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-09 17:56:53 UTC, "created_at"=>2015-06-09 17:56:53 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5870ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('557728e56e6b752440030000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-09 17:56:53 UTC, "created_at"=>2015-06-09 17:56:53 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5820ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6640ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.3230ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3770ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3900ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3540ms
------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_removal
------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3600ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3870ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4050ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5320ms
  Rendered inline template (0.4ms)
  Rendered inline template (0.2ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('557728e56e6b752440050000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5130ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('557728e56e6b752440060000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('557728e56e6b752440050000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-09 17:56:53 UTC, "created_at"=>2015-06-09 17:56:53 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5910ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('557728e56e6b752440050000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-09 17:56:53 UTC, "created_at"=>2015-06-09 17:56:53 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.8270ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5760ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3990ms
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('557728e56e6b752440050000')} update={"$set"=>{"updated_at"=>2015-06-08 00:00:00 UTC}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3830ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5040ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4650ms
  Rendered inline template (0.2ms)
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('557728e56e6b752440070000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('557728e56e6b752440050000')}], "scope"=>"page", "original"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}}, "modified"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}}, "version"=>2, "action"=>"update", "updated_at"=>2015-06-09 17:56:53 UTC, "created_at"=>2015-06-09 17:56:53 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5840ms
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('557728e56e6b752440050000')} update={"$set"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "updated_at"=>2015-06-09 17:56:53 UTC, "version"=>2}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4640ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.2970ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4040ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4210ms
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3710ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3850ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2780ms
  Rendered inline template (0.3ms)
  Rendered inline template (0.2ms)
  Rendered inline template (0.2ms)
  Rendered inline template (0.2ms)
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4640ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3130ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2490ms
---------------------------------------------------------------------
SyncTest: test_check_initial_synchronization_of_templates_with_models
---------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 COMMAND      database=admin command={:ismaster=>1} runtime: 1.1610ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4150ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3010ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2740ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5090ms
  Rendered inline template (1.0ms)
  Rendered inline template (0.3ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('557729106e6b75246c000000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6290ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('557729106e6b75246c010000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('557729106e6b75246c000000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-09 17:57:36 UTC, "created_at"=>2015-06-09 17:57:36 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.9260ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('557729106e6b75246c000000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-09 17:57:36 UTC, "created_at"=>2015-06-09 17:57:36 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.6320ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.5020ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.4010ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.6910ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.6760ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.5830ms
------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_removal
------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4930ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3650ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3240ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.2650ms
  Rendered inline template (0.3ms)
  Rendered inline template (0.3ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('557729106e6b75246c020000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4590ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('557729106e6b75246c030000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('557729106e6b75246c020000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-09 17:57:36 UTC, "created_at"=>2015-06-09 17:57:36 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5140ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('557729106e6b75246c020000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-09 17:57:36 UTC, "created_at"=>2015-06-09 17:57:36 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3620ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3520ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.5130ms
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('557729106e6b75246c020000')} update={"$set"=>{"updated_at"=>2015-06-08 00:00:00 UTC}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4130ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4050ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3710ms
  Rendered inline template (0.3ms)
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('557729106e6b75246c040000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('557729106e6b75246c020000')}], "scope"=>"page", "original"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}}, "modified"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}}, "version"=>2, "action"=>"update", "updated_at"=>2015-06-09 17:57:36 UTC, "created_at"=>2015-06-09 17:57:36 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.6020ms
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('557729106e6b75246c020000')} update={"$set"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "updated_at"=>2015-06-09 17:57:36 UTC, "version"=>2}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4670ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.3150ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4740ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.4990ms
-------------------------------------------------------------------------------
SyncTest: test_check_synchronization_of_templates_with_models_on_block_creation
-------------------------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3750ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3810ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3490ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4280ms
  Rendered inline template (0.4ms)
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"_slugs"=>{"$all"=>[/^pages\-about(?:-(\d+))?$/]}, "_id"=>{"$ne"=>BSON::ObjectId('557729106e6b75246c050000')}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.4880ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('557729106e6b75246c060000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('557729106e6b75246c050000')}], "scope"=>"page", "original"=>{}, "modified"=>{"_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb"}, "version"=>1, "action"=>"create", "updated_at"=>2015-06-09 17:57:36 UTC, "created_at"=>2015-06-09 17:57:36 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.5000ms
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=pages documents=[{"_id"=>BSON::ObjectId('557729106e6b75246c050000'), "_page_title"=>"", "_page_description"=>"", "_page_keywords"=>"", "_page_image_url"=>"", "_name"=>"About", "_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}, "_slugs"=>["pages-about"], "hero_image_url"=>"", "_template_name"=>"pages/about.html.erb", "updated_at"=>2015-06-09 17:57:36 UTC, "created_at"=>2015-06-09 17:57:36 UTC, "version"=>1}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3720ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.6540ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.5860ms
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('557729106e6b75246c050000')} update={"$set"=>{"updated_at"=>2015-06-08 00:00:00 UTC}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3820ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3420ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3630ms
  Rendered inline template (0.3ms)
  Rendered inline template (0.2ms)
  MOPED: 127.0.0.1:27017 INSERT       database=inverter_test collection=history_trackers documents=[{"_id"=>BSON::ObjectId('557729106e6b75246c070000'), "association_chain"=>[{"name"=>"Page", "id"=>BSON::ObjectId('557729106e6b75246c050000')}], "scope"=>"page", "original"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      "}}, "modified"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}}, "version"=>2, "action"=>"update", "updated_at"=>2015-06-09 17:57:36 UTC, "created_at"=>2015-06-09 17:57:36 UTC}] flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4250ms
  MOPED: 127.0.0.1:27017 UPDATE       database=inverter_test collection=pages selector={"_id"=>BSON::ObjectId('557729106e6b75246c050000')} update={"$set"=>{"_blocks"=>{"subtitle"=>"\n        <p>This is an example of subtitle block</p>\n      ", "footer"=>"\n        <p>This is an example of the content block named footer.</p>\n      "}, "updated_at"=>2015-06-09 17:57:36 UTC, "version"=>2}} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3890ms
  MOPED: 127.0.0.1:27017 COMMAND      database=inverter_test command={:count=>"pages", :query=>{}} runtime: 0.2430ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3820ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3300ms
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=pages selector={"$query"=>{}, "$orderby"=>{"created_at"=>1}} flags=[] limit=-1 skip=0 batch_size=nil fields=nil runtime: 0.3360ms
---------------------------------------------------------------
ParserTest: test_returns_empty_hash_for_template_without_blocks
---------------------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3010ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2800ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.2680ms
---------------------------------------------
ParserTest: test_parses_templates_with_blocks
---------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.3070ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3840ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.3160ms
  Rendered inline template (0.5ms)
  Rendered inline template (0.4ms)
  Rendered inline template (0.2ms)
  Rendered inline template (0.2ms)
------------------------------------------
RendererTest: test_change_html_with_blocks
------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.9910ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.7190ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4410ms
-----------------------------------------------------
RendererTest: test_doesn't_change_html_without_blocks
-----------------------------------------------------
  MOPED: 127.0.0.1:27017 QUERY        database=inverter_test collection=system.namespaces selector={:name=>{"$not"=>/\.system\.|\$/}} flags=[] limit=0 skip=0 batch_size=nil fields=nil runtime: 0.7000ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=history_trackers selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4250ms
  MOPED: 127.0.0.1:27017 DELETE       database=inverter_test collection=pages selector={} flags=[]
                         COMMAND      database=inverter_test command={:getlasterror=>1, :w=>1} runtime: 0.4010ms
